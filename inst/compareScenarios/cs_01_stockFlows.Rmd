# Stock and flows

## Building stock

```{r stock vars}
tot <- "Stock|Buildings"
subsec <- c("Stock|Residential",
            "Stock|Commercial")
```

```{r StockSubsector}
showAreaAndBarPlots(data, vars = subsec, tot = tot, orderVars = "user", scales = "fixed")
```

### All buildings

### Residential
```{r residential stock vars}
tot <- "Stock|Residential"
heatingRes <- paste(tot, heating, sep = "|")
vintageRes <- paste(tot, vintage, sep = "|")
typeRes <- paste(tot, type, sep = "|")
locationRes <- paste(tot, location, sep = "|")
```

#### by building type
```{r Stock-Residential-(type)}
showAreaAndBarPlots(data, vars = typeRes, tot = tot, orderVars = "user", scales = "fixed")
walk(typeRes, showLinePlots, data = data)
```

#### by location
```{r Stock-Residential-(location)}
showAreaAndBarPlots(data, vars = locationRes, tot = tot, orderVars = "user", scales = "fixed")
walk(locationRes, showLinePlots, data = data)
```

#### by Construction cohort
```{r Stock-Residential-(vintage)}
showAreaAndBarPlots(data, vars = rev(vintageRes), tot = tot, orderVars = "user", scales = "fixed")
```

#### by Space heating
```{r Stock-Residential-(heating)}
showAreaAndBarPlots(data, vars = heatingRes, tot = tot, orderVars = "user", scales = "fixed")
walk(heatingRes, showLinePlots, data = data)
```

### Commercial

## Construction flow

```{r construction vars}
tot <- "Construction|Buildings"
subsec <- c("Construction|Residential",
            "Construction|Commercial")
```

```{r ConstructionSubsector}
showAreaAndBarPlots(data, vars = subsec, tot = tot, orderVars = "user", scales = "fixed")
```

### All buildings

### Residential
```{r residential construction vars}
tot <- "Construction|Residential"
heatingRes <- paste(tot, heating, sep = "|")
typeRes <- paste(tot, type, sep = "|")
locationRes <- paste(tot, location, sep = "|")
```

#### by building type
```{r Construction-Residential-(type)}
showAreaAndBarPlots(data, vars = typeRes, tot = tot, orderVars = "user", scales = "fixed")
walk(typeRes, showLinePlots, data = data)
```

#### by location
```{r Construction-Residential-(location)}
showAreaAndBarPlots(data, vars = locationRes, tot = tot, orderVars = "user", scales = "fixed")
walk(locationRes, showLinePlots, data = data)
```

#### by Space heating
```{r Construction-Residential-(heating)}
showAreaAndBarPlots(data, vars = heatingRes, tot = tot, orderVars = "user", scales = "fixed")
walk(heatingRes, showLinePlots, data = data)
```

### Commercial

## Renovation flow of the shell

```{r shell renovation vars}
tot <- "Renovation|Buildings|Shell"
subsec <- c("Renovation|Residential|Shell",
            "Renovation|Commercial|Shell")
```

```{r Renovation-Subsector-Shell}
showAreaAndBarPlots(data, vars = subsec, tot = tot, orderVars = "user", scales = "fixed")
```

### All buildings

### Residential
```{r residential shell Renovation vars}
tot <- "Renovation|Residential|Shell"
identReplRes <- paste(tot, c("Identical replacement", "Effective change"), sep = "|")
```

#### by building type
```{r Renovation-Residential-Shell-(type)}
showAreaAndBarPlots(data, vars = paste(tot, type, sep = "|"), tot = tot,
                    orderVars = "user", scales = "fixed")
walk(paste(tot, type, sep = "|"), showLinePlots, data = data)
```

#### by location
```{r Renovation-Residential-Shell-(location)}
showAreaAndBarPlots(data, vars = paste(tot, location, sep = "|"), tot = tot,
                    orderVars = "user", scales = "fixed")
walk(paste(tot, location, sep = "|"), showLinePlots, data = data)
```

#### by building shell (initial state)
```{r Renovation-Residential-(shellBefore)}
showAreaAndBarPlots(data, vars = paste(tot, "Initial", shell, sep = "|"), orderVars = "user", scales = "fixed")
walk(paste(tot, "Initial", shell, sep = "|"), showLinePlots, data = data)
```

#### by building shell (final state)
```{r Renovation-Residential-(shellAfter)}
showAreaAndBarPlots(data, vars = paste(tot, "Final", shell, sep = "|"), orderVars = "user", scales = "fixed")
walk(paste(tot, "Final", shell, sep = "|"), showLinePlots, data = data)
```

#### by identical replacement or not
```{r Renovation-Residential-Heating-(identicalReplacement)}
showAreaAndBarPlots(data, vars = identReplRes, orderVars = "user", scales = "fixed")
```

### Commercial

## Renovation flow of the heating system

```{r heating renovation vars}
tot <- "Renovation|Buildings|Heating"
subsec <- c("Renovation|Residential|Heating",
            "Renovation|Commercial|Heating")
```

```{r Renovation-Subsector-Heating}
showAreaAndBarPlots(data, vars = subsec, tot = tot, orderVars = "user", scales = "fixed")
```

### All buildings

### Residential
```{r residential Renovation vars}
tot <- "Renovation|Residential|Heating"
identReplRes <- paste(tot, c("Identical replacement", "Effective change"), sep = "|")
identReplHsRes <- paste(tot, c("Identical replacement", "Effective change|Final"), sep = "|")
identReplHsRes <- lapply(heating, function(hsr) {
  paste(identReplHsRes, hsr, sep = "|")
})
```

#### by building type
```{r Renovation-Residential-Heating-(type)}
showAreaAndBarPlots(data, vars = paste(tot, type, sep = "|"), tot = tot,
                    orderVars = "user", scales = "fixed")
walk(paste(tot, type, sep = "|"), showLinePlots, data = data)
```

#### by location
```{r Renovation-Residential-Heating-(location)}
showAreaAndBarPlots(data, vars = paste(tot, location, sep = "|"), tot = tot,
                    orderVars = "user", scales = "fixed")
walk(paste(tot, location, sep = "|"), showLinePlots, data = data)
```

#### by Space heating (initial state)
```{r Renovation-Residential-(heatingBefore)}
showAreaAndBarPlots(data, vars = paste(tot, "Initial", heating, sep = "|"),
                    orderVars = "user", scales = "fixed")
walk(paste(tot, "Initial", heating, sep = "|"), showLinePlots, data = data)
```

#### by Space heating (final state)
```{r Renovation-Residential-(heatingAfter)}
showAreaAndBarPlots(data, vars = paste(tot, "Final", heating, sep = "|"),
                    orderVars = "user", scales = "fixed")
```

#### by Space heating (final state, with zero renovation)
```{r Renovation-Residential-(heatingAfter)}
showAreaAndBarPlots(data, vars =  paste(tot, "Final", heating0, sep = "|"),
                    orderVars = "user", scales = "fixed")
walk(paste(tot, "Final", heating0, sep = "|"), showLinePlots, data = data)
```

#### by identical replacement or not
```{r Renovation-Residential-Heating-(identicalReplacement)}
showAreaAndBarPlots(data, vars = identReplRes, orderVars = "user", scales = "fixed")
```

#### by identical replacement and by heating system
```{r Renovation-Residential-(heating-identicalReplacement)}
showAreaAndBarPlots(data, vars = unlist(identReplHsRes), orderVars = "user", scales = "fixed")
finalHs <- lapply(heating, function(hsr) {
  paste(tot, "Final", hsr, sep = "|")
})
walk2(identReplHsRes, finalHs, showAreaAndBarPlots, data = data, orderVars = "user", scales = "fixed")
```

### Commercial
